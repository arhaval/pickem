-- Predictions Tablosu için RLS Politikaları
-- HATA ALDIYSANIZ: user_id kolonu UUID tipindeyse PREDICTIONS_RLS_UUID_VERSIYON.txt dosyasını kullanın
-- HATA ALDIYSANIZ: user_id kolonu TEXT tipindeyse PREDICTIONS_RLS_TEXT_VERSIYON.txt dosyasını kullanın

-- Bu versiyon UUID tipi içindir (en yaygın durum)
-- RLS'yi aktif et
ALTER TABLE predictions ENABLE ROW LEVEL SECURITY;

-- Mevcut politikaları temizle (varsa)
DROP POLICY IF EXISTS "Kullanıcılar kendi tahminlerini ekleyebilir" ON predictions;
DROP POLICY IF EXISTS "Kullanıcılar kendi tahminlerini görebilir" ON predictions;

-- INSERT Politikası: Kullanıcılar kendi user_id'leri ile tahmin ekleyebilir
CREATE POLICY "Kullanıcılar kendi tahminlerini ekleyebilir"
ON predictions
FOR INSERT
TO authenticated
WITH CHECK (auth.uid() = user_id);

-- SELECT Politikası: Kullanıcılar kendi tahminlerini görebilir
CREATE POLICY "Kullanıcılar kendi tahminlerini görebilir"
ON predictions
FOR SELECT
TO authenticated
USING (auth.uid() = user_id);

